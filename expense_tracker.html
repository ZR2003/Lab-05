<!DOCTYPE html>
<html>
<head>
    <title>Expense Tracker</title>
    <style>
        .expense-form { margin: 20px; padding: 20px; border: 1px solid #ccc; }
        .form-group { margin: 10px 0; }
        label { display: inline-block; width: 100px; }
        .expense-table { margin: 20px; }
        table { width: 100%; border-collapse: collapse; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        .filter { margin: 10px 0; }
        .error { border: 2px solid red; }
    </style>
</head>
<body>
    <h1>Expense Tracker</h1>
    
    <div class="expense-form">
        <h2>Add New Expense</h2>
        <form id="expenseForm">
            <div class="form-group">
                <label for="description">Description:</label>
                <input type="text" id="description" name="description">
            </div>
            <div class="form-group">
                <label for="amount">Amount:</label>
                <input type="number" id="amount" name="amount" step="0.01">
            </div>
            <div class="form-group">
                <label for="category">Category:</label>
                <select id="category" name="category">
                    <option value="">Select Category</option>
                    <option value="Food">Food</option>
                    <option value="Transport">Transport</option>
                    <option value="Entertainment">Entertainment</option>
                    <option value="Utilities">Utilities</option>
                    <option value="Other">Other</option>
                </select>
            </div>
            <button type="button" onclick="addExpense()">Add Expense</button>
            <button type="button" onclick="resetForm()">Reset All</button>
        </form>
    </div>

    <div class="filter">
        <label>Filter by Category:</label>
        <select id="categoryFilter" onchange="filterExpenses()">
            <option value="">All Categories</option>
            <option value="Food">Food</option>
            <option value="Transport">Transport</option>
            <option value="Entertainment">Entertainment</option>
            <option value="Utilities">Utilities</option>
            <option value="Other">Other</option>
        </select>
    </div>

    <div class="expense-table">
        <h2>Expense List</h2>
        <table id="expenseTable">
            <thead>
                <tr>
                    <th>Description</th>
                    <th>Amount</th>
                    <th>Category</th>
                    <th>Date</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody id="expenseList"></tbody>
            <tfoot>
                <tr>
                    <td colspan="4"><strong>Total Expenses:</strong></td>
                    <td id="totalAmount">$0.00</td>
                </tr>
            </tfoot>
        </table>
    </div>

    <script>
        // Expense constructor function
        function Expense(description, amount, category) {
            this.description = description;
            this.amount = amount;
            this.category = category;
            this.date = new Date().toLocaleDateString();
            this.id = Date.now() + Math.random();
        }
        
        let expenses = [];
        let filteredExpenses = [];
        
        function addExpense() {
            try {
                const description = document.getElementById('description').value.trim();
                const amount = parseFloat(document.getElementById('amount').value);
                const category = document.getElementById('category').value;
                
                // Validation
                if (!description) {
                    throw new Error('Description cannot be empty');
                }
                
                if (isNaN(amount) || amount <= 0) {
                    throw new Error('Please enter a valid positive amount');
                }
                
                if (!category) {
                    throw new Error('Please select a category');
                }
                
                // Create new expense
                const newExpense = new Expense(description, amount, category);
                expenses.push(newExpense);
                
                // Update display
                displayExpenses();
                updateTotal();
                
                // Clear form
                resetForm();
                
            } catch (error) {
                console.error('Error adding expense:', error.message);
                alert('Error: ' + error.message);
            }
        }
        
        function deleteExpense(id) {
            try {
                const index = expenses.findIndex(expense => expense.id === id);
                if (index === -1) {
                    throw new Error('Expense not found');
                }
                
                expenses.splice(index, 1);
                displayExpenses();
                updateTotal();
                
            } catch (error) {
                console.error('Error deleting expense:', error.message);
                alert('Error: ' + error.message);
            }
        }
        
        function filterExpenses() {
            const category = document.getElementById('categoryFilter').value;
            
            if (category === '') {
                filteredExpenses = [...expenses];
            } else {
                filteredExpenses = expenses.filter(expense => expense.category === category);
            }
            
            displayExpenses();
            updateTotal();
        }
        
        function displayExpenses() {
            const expenseList = document.getElementById('expenseList');
            const displayArray = filteredExpenses.length > 0 ? filteredExpenses : expenses;
            
            expenseList.innerHTML = '';
            
            // Loop through expenses and create table rows
            displayArray.forEach(expense => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${expense.description}</td>
                    <td>$${expense.amount.toFixed(2)}</td>
                    <td>${expense.category}</td>
                    <td>${expense.date}</td>
                    <td>
                        <button onclick="deleteExpense(${expense.id})">Delete</button>
                    </td>
                `;
                expenseList.appendChild(row);
            });
        }
        
        function updateTotal() {
            const displayArray = filteredExpenses.length > 0 ? filteredExpenses : expenses;
            const total = displayArray.reduce((sum, expense) => sum + expense.amount, 0);
            document.getElementById('totalAmount').textContent = `$${total.toFixed(2)}`;
        }
        
        function resetForm() {
            document.getElementById('expenseForm').reset();
        }
        
        // Initialize display
        displayExpenses();
        updateTotal();
    </script>
</body>
</html>