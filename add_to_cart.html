<!DOCTYPE html>
<html>
<head>
    <title>Shopping Cart</title>
    <style>
        .product { border: 1px solid #ccc; padding: 10px; margin: 10px; }
        .cart { margin-top: 20px; }
        table { width: 100%; border-collapse: collapse; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
    </style>
</head>
<body>
    <h2>Products</h2>
    <div id="products">
        <div class="product">
            <h3>Laptop - $999</h3>
            <button onclick="addToCart('Laptop', 999)">Add to Cart</button>
        </div>
        <div class="product">
            <h3>Mouse - $25</h3>
            <button onclick="addToCart('Mouse', 25)">Add to Cart</button>
        </div>
        <div class="product">
            <h3>Keyboard - $45</h3>
            <button onclick="addToCart('Keyboard', 45)">Add to Cart</button>
        </div>
    </div>

    <div class="cart">
        <h2>Shopping Cart</h2>
        <table id="cartTable">
            <thead>
                <tr>
                    <th>Item</th>
                    <th>Price</th>
                    <th>Quantity</th>
                    <th>Total</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody id="cartItems"></tbody>
            <tfoot>
                <tr>
                    <td colspan="3"><strong>Grand Total</strong></td>
                    <td id="grandTotal">$0</td>
                    <td></td>
                </tr>
            </tfoot>
        </table>
    </div>

    <script>
        let cart = [];
        
        function addToCart(itemName, price) {
            try {
                // Validate inputs
                if (!itemName || typeof price !== 'number' || price <= 0) {
                    throw new Error('Invalid item or price');
                }
                
                // Check if item already exists in cart
                const existingItem = cart.find(item => item.name === itemName);
                
                if (existingItem) {
                    existingItem.quantity++;
                } else {
                    cart.push({
                        name: itemName,
                        price: price,
                        quantity: 1
                    });
                }
                
                updateCartDisplay();
                
            } catch (error) {
                console.error('Error adding to cart:', error.message);
                alert('Error: ' + error.message);
            }
        }
        
        function removeFromCart(index) {
            try {
                if (index < 0 || index >= cart.length) {
                    throw new Error('Invalid item index');
                }
                
                cart.splice(index, 1);
                updateCartDisplay();
                
            } catch (error) {
                console.error('Error removing item:', error.message);
                alert('Error: ' + error.message);
            }
        }
        
        function updateCartDisplay() {
            const cartItems = document.getElementById('cartItems');
            const grandTotalElem = document.getElementById('grandTotal');
            
            // Clear current display
            cartItems.innerHTML = '';
            
            let total = 0;
            
            // Loop through cart items and update display
            cart.forEach((item, index) => {
                const itemTotal = item.price * item.quantity;
                total += itemTotal;
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${item.name}</td>
                    <td>$${item.price}</td>
                    <td>${item.quantity}</td>
                    <td>$${itemTotal}</td>
                    <td><button onclick="removeFromCart(${index})">Remove</button></td>
                `;
                cartItems.appendChild(row);
            });
            
            grandTotalElem.textContent = `$${total}`;
        }
    </script>
</body>
</html>